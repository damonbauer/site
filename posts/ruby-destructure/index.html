<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="description" content="Argument Destructuring In Ruby" />
    <title>Argument Destructuring In Ruby</title>
    <style type="text/css">body{max-width:600px;font-size:20px}</style>
  </head>
  <body>
    <header>
      <a href="/">damon bauer's blog</a><br>
      <span>developer, amateur woodworker</span>
    </header><br><br>

    <small>2019-12-29</small>
    <h1 style="margin-top:0">
      Argument Destructuring In Ruby
    </h1>
    <p>With a hash in the following structure:</p>
<pre><code class="language-ruby">{
  &quot;2019-12-01&quot;: [{title: &quot;a title&quot;}, {title: &quot;another title&quot;}],
  &quot;2019-11-01&quot;: [{title: &quot;a title&quot;}, {title: &quot;another title&quot;}],
  ...
}
</code></pre>
<p>I wanted to iterate over it and find out the index of the iteration. This is easy enough to do, like so:</p>
<pre><code class="language-ruby">hash.each_with_index.map { |collection, index| ... }
</code></pre>
<p>The problem lies with the <code>collection</code> argument. Since my &quot;collection&quot; in each iteration is a key (&quot;2019-12-01&quot;) and a value (the array of hashes), the <code>collection</code> argument doesn't really tell me a whole lot about what it contains.</p>
<p>Let's say I wanted to display the date and render a partial for each hash in the array:</p>
<pre><code class="language-ruby">&lt;% hash.each_with_index.map { |collection, index| ... } %&gt;
  &lt;div id=&quot;container-&lt;%= index %&gt;&quot;&gt;
    &lt;p&gt;Date: &lt;%= collection.first %&gt;&lt;/p&gt;
    &lt;%= render partial: &quot;items&quot; collection: collection.second %&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code></pre>
<p>The <code>collection.first</code> and <code>collection.second</code> have no meaning and are really difficult to understand what they are, so I wanted to fix that.</p>
<p>I could &quot;add&quot; meaning, at the cost of assigning 2 variables in each iteration:</p>
<pre><code class="language-ruby">&lt;% hash.each_with_index.map { |collection, index| ... } %&gt;
  &lt;% date = collection.first %&gt;
  &lt;% items = collection.second %&gt;
  
  &lt;div id=&quot;container-&lt;%= index %&gt;&quot;&gt;
    &lt;p&gt;Date: &lt;%= date %&gt;&lt;/p&gt;
    &lt;%= render partial: &quot;items&quot; collection: items %&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code></pre>
<p>However, I don't like this approach because:</p>
<ol>
<li>The aforementioned need to assign variables in each iteration</li>
<li>This works for a simple key/value hash setup like this example, but might not work for anything more complex</li>
<li>If the order of the <code>collection</code> hash changes, the variable have to change, too</li>
</ol>
<p>Coming from the JavaScript world, I've used <code>destructuring</code> quite often:</p>
<pre><code class="language-js">const obj = { a: &quot;foo&quot;, b: &quot;bar&quot; }

// destructure
const { a, b } = obj;

console.log(a) // &quot;foo&quot;
console.log(b) // &quot;bar&quot;
</code></pre>
<p>Well, I learned that Ruby has destructuring as well. So, my code can become:</p>
<pre><code class="language-ruby">&lt;% hash.each_with_index.map { |(date, items), index| ... } %&gt;
  &lt;div id=&quot;container-&lt;%= index %&gt;&quot;&gt;
    &lt;p&gt;Date: &lt;%= date %&gt;&lt;/p&gt;
    &lt;%= render partial: &quot;items&quot; collection: items %&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code></pre>

    <a href="/">‚Üê Back</a>
  </body>
</html>
